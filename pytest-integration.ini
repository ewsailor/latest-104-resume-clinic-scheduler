[tool:pytest]
# ===== 整合測試專用配置設定 =====
# 測試目錄設定：指定整合測試檔案所在的位置
testpaths = tests/integration

# 定義可用的測試標記，用於分類和篩選測試
markers =
    integration: 整合測試
    slow: 慢速測試（執行時間較長的測試）
    health: 健康檢查測試
    schedule: 時段管理測試
    main: 主要路由測試

# 測試發現規則：定義 pytest 如何發現和識別測試檔案、類別和函數
python_files = test_*.py      # 測試檔案命名規則
python_classes = Test*        # 測試類別命名規則
python_functions = test_*     # 測試函數命名規則

# 測試執行選項：設定測試執行時的輸出格式和行為
addopts = 
    -v                       # 詳細輸出模式
    --tb=short               # 簡短的錯誤追蹤資訊
    --strict-markers         # 嚴格檢查標記定義
    --disable-warnings       # 禁用警告訊息
    --color=yes              # 啟用彩色輸出

# ===== 程式碼覆蓋率設定 ======
# 覆蓋率收集設定
[coverage:run]
# 指定要收集覆蓋率的原始碼目錄
source = app
# 排除不需要覆蓋率檢查的目錄
omit = 
    */tests/*                # 測試檔案
    */migrations/*           # 資料庫遷移檔案
    */alembic/*              # Alembic 遷移工具檔案

# 覆蓋率報告設定
[coverage:report]
# 排除覆蓋率統計的程式碼行
exclude_lines =
    pragma: no cover          # 標記為不覆蓋的行
    def __repr__              # __repr__ 方法
    raise AssertionError      # 斷言錯誤
    raise NotImplementedError # 未實作錯誤
